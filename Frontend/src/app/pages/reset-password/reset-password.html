<section class="auth-page">
  <div class="auth-shell single">
    <div class="form-card">
      <h2>Reset password</h2>
      <p class="subtitle">Set a new password for your account.</p>

      <p *ngIf="success" class="notice info">{{ success }}</p>
      <p *ngIf="error" class="notice error">{{ error }}</p>

      <form (ngSubmit)="submit()" class="auth-form">
        <label class="field">
          <span>Email</span>
          <input type="email" [(ngModel)]="email" name="email" autocomplete="email" required />
        </label>

        <label class="field">
          <span>Verification token</span>
          <input type="text" [(ngModel)]="token" name="token" [readonly]="tokenFromLink" required />
        </label>
        <p *ngIf="tokenFromLink" class="hint">Token loaded from reset link.</p>

        <label class="field">
          <span>New password</span>
          <div class="password-row">
            <input [type]="showPassword ? 'text' : 'password'" [(ngModel)]="password" name="password" autocomplete="new-password" required />
            <button type="button" class="ghost-btn" (click)="toggleShowPassword()">{{ showPassword ? 'Hide' : 'Show' }}</button>
          </div>
        </label>
        <p class="hint">{{ passwordPolicyHint() }}</p>

        <label class="field">
          <span>Confirm password</span>
          <div class="password-row">
            <input [type]="showConfirmPassword ? 'text' : 'password'" [(ngModel)]="confirmPassword" name="confirmPassword" autocomplete="new-password" required />
            <button type="button" class="ghost-btn" (click)="toggleShowConfirmPassword()">{{ showConfirmPassword ? 'Hide' : 'Show' }}</button>
          </div>
        </label>
        <p *ngIf="passwordMatchHint()" [class]="passwordsMatch() ? 'hint ok' : 'hint warn'">{{ passwordMatchHint() }}</p>

        <button type="submit" class="primary-btn" [disabled]="submitting">{{ submitting ? 'Updating...' : 'Update password' }}</button>
      </form>

      <p class="footnote"><a routerLink="/login">Back to sign in</a></p>
    </div>
  </div>
</section>
