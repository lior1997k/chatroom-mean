<!-- Toast notifications will be implemented inline -->

<!-- Preview Modal - at the top for better rendering -->
<!-- Preview modal moved to top; duplicate bottom modal removed to avoid conflicts -->

<section class="profile-page" *ngIf="!loading; else loadingTpl">
  <header class="topbar">
    <div>
      <p class="eyebrow">Account center</p>
      <h1>Profile & security</h1>
    </div>
    <button type="button" class="dark-mode-toggle" (click)="toggleTheme()" 
            [title]="currentTheme === 'dark' ? 'Switch to light mode' : 'Switch to dark mode'"
            aria-label="Toggle dark mode">
      <span *ngIf="currentTheme === 'light'">üåô</span>
      <span *ngIf="currentTheme === 'dark'">‚òÄÔ∏è</span>
    </button>
    <button type="button" class="ghost" (click)="goToChat()">Back to chat</button>
  </header>

  <!-- Tab Navigation -->
  <nav class="tab-nav">
    <button type="button" 
            class="tab-button" 
            [class.active]="activeTab === 'profile'"
            (click)="selectTab('profile')">
      Public Profile
    </button>
    <button type="button" 
            class="tab-button" 
            [class.active]="activeTab === 'security'"
            (click)="selectTab('security')">
      Security
    </button>
    <button type="button" 
            class="tab-button" 
            [class.active]="activeTab === 'admin'"
            *ngIf="isModeratorOrHigher()"
            (click)="selectTab('admin')">
      Moderation
    </button>
  </nav>

  <!-- Profile Tab Content -->
  <div class="layoutGrid" *ngIf="activeTab === 'profile'">
    <!-- Left Column - Profile Summary -->
    <aside class="card profileHero">
      <div class="profile-summary">
        <div class="avatarRow">
          <div class="avatarWrap">
            <img *ngIf="avatarPreviewUrl(); else noAvatar" [src]="avatarPreviewUrl()" alt="avatar preview" class="avatarPreview" />
            <ng-template #noAvatar>
              <div class="avatarPlaceholder">No avatar</div>
            </ng-template>
            <span *ngIf="isBirthdayToday()" class="giftBadge" title="Happy birthday">üéÅ</span>
          </div>
          <div class="avatarActions">
            <label class="uploadBtn">
              Upload avatar
              <input type="file" accept="image/*" (change)="onAvatarSelected($event)" />
            </label>
            <span class="small" *ngIf="uploadingAvatar">Uploading and saving...</span>
          </div>
        </div>
        <h2>{{ displayName || me?.username }}</h2>
        <p class="username">@{{ me?.username }}</p>
        <p class="meta">{{ me?.email || 'no email' }}</p>
        
        <div class="details">
          <p class="meta"><span class="label">Role:</span> <strong>{{ me?.role }}</strong></p>
          <p class="meta"><span class="label">Status:</span> {{ me?.emailVerified ? '‚úì Verified' : 'Unverified' }}</p>
          <p class="meta"><span class="label">Joined:</span> {{ me?.createdAt | date:'mediumDate' }}</p>
        </div>

        <div class="completion-score">
          <div class="completion-header">
            <span>Profile completeness</span>
            <span class="completion-label">{{ getProfileCompletionScore() }}%</span>
          </div>
          <div class="completion-bar">
            <div class="completion-fill" [style.width.%]="getProfileCompletionScore()"></div>
          </div>
        </div>

        <span class="small note">Username and birth date are fixed after creation.</span>
      </div>
    </aside>

    <!-- Right Column - Profile Form -->
    <article class="card profile-card">
      <div class="card-header">
        <div class="card-icon profile">
          <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg>
        </div>
        <div>
          <h2>Public profile</h2>
          <p class="card-subtitle">Customize how others see your profile</p>
        </div>
      </div>

      <div class="form-section">
        <h3><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"/></svg> Basic Info</h3>
        <div class="formGrid">
          <label>
            <span>Display name</span>
            <input type="text" [(ngModel)]="displayName" name="displayName" maxlength="60" (ngModelChange)="onDisplayNameInput($event)" />
            <span class="small warn" *ngIf="displayNameTaken">Display name is already taken.</span>
          </label>
          <label>
            <span>Status</span>
            <input type="text" [(ngModel)]="statusText" name="statusText" maxlength="120" />
          </label>
          <label>
            <span>Gender</span>
            <select [(ngModel)]="gender" name="gender" (ngModelChange)="onGenderChange($event)">
              <option value="male">male</option>
              <option value="female">female</option>
              <option value="other">other</option>
            </select>
          </label>
          <label>
            <span>Birth date</span>
            <input type="date" [(ngModel)]="birthDate" name="birthDate" />
          </label>
          <label class="full">
            <span>Bio</span>
            <textarea [(ngModel)]="bio" name="bio" rows="3" maxlength="240"></textarea>
          </label>
        </div>
      </div>

      <div class="form-section">
        <h3><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-1 17.93c-3.95-.49-7-3.85-7-7.93 0-.62.08-1.21.21-1.79L9 15v1c0 1.1.9 2 2 2v1.93zm6.9-2.54c-.26-.81-1-1.39-1.9-1.39h-1v-3c0-.55-.45-1-1-1H8v-2h2c.55 0 1-.45 1-1V7h2c1.1 0 2-.9 2-2v-.41c2.93 1.19 5 4.06 5 7.41 0 2.08-.8 3.97-2.1 5.39z"/></svg> Personal Info</h3>
        <div class="formGrid">
          <label class="switchLabel full">
            <input type="checkbox" [(ngModel)]="showCountry" name="showCountry" />
            <span>Display country on public profile</span>
          </label>
          <label class="switchLabel full">
            <input type="checkbox" [(ngModel)]="showAge" name="showAge" />
            <span>Display age on public profile</span>
          </label>
          <label>
            <span>Last seen visibility</span>
            <select [(ngModel)]="lastSeenVisibility" name="lastSeenVisibility">
              <option value="everyone">Everyone</option>
              <option value="contacts">Contacts</option>
              <option value="nobody">Nobody</option>
            </select>
          </label>
        </div>
      </div>

      <div class="form-section">
        <h3><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M9.101 23.691v-7.98H6.627v-3.667h2.474v-1.58c0-4.085 1.848-5.978 5.858-5.978.401 0 .955.042 1.468.103a8.68 8.68 0 0 1 1.141.195v3.325a8.623 8.623 0 0 0-.653-.036 26.805 26.805 0 0 0-.733-.009c-.707 0-1.259.096-1.675.309a1.686 1.686 0 0 0-.679.622c-.258.42-.374.995-.374 1.752v1.297h3.919l-.386 2.103-.287 1.564h-3.246v8.245C19.396 23.238 24 18.179 24 12.044c0-6.627-5.373-12-12-12s-12 5.373-12 12c0 5.628 3.874 10.35 9.101 11.647Z"/></svg> Social Links</h3>
        <div class="social-links-grid">
          <div class="social-link-row" *ngFor="let platform of socialPlatforms">
            <span [innerHTML]="getPlatformSvgSafe(platform.id)" class="social-icon-img" [title]="platform.name"></span>
            <input type="url" 
                   [placeholder]="platform.placeholder" 
                   [ngModel]="getSocialLink(platform.id)"
                   (ngModelChange)="setSocialLink(platform.id, $event)"
                   [name]="platform.id" />
            <span class="warn" *ngIf="!isValidSocialLink(platform.id)" title="Invalid URL format">
              <svg viewBox="0 0 24 24" width="16" height="16" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-2h2v2zm0-4h-2V7h2v6z"/></svg>
            </span>
          </div>
        </div>
      </div>

      <div class="form-section">
        <h3><svg viewBox="0 0 24 24" width="18" height="18" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg> Privacy</h3>
        <div class="formGrid">
          <label class="switchLabel full">
            <input type="checkbox" [(ngModel)]="showGender" name="showGender" />
            <span>Display gender on public profile</span>
          </label>
          <label class="switchLabel full">
            <input type="checkbox" [(ngModel)]="showOnlineStatus" name="showOnlineStatus" />
            <span>Display online status</span>
          </label>
        </div>
      </div>

      <div class="actionRow">
        <button type="button" class="primary" [disabled]="savingProfile" (click)="saveProfile()">
          {{ savingProfile ? 'Saving...' : 'Save profile' }}
        </button>
        <button type="button" class="ghost" (click)="openPreview()">Preview</button>
      </div>
    </article>
  </div>

  <!-- Security Tab Content -->
  <article class="card security-card" *ngIf="activeTab === 'security'">
    <div class="card-header">
      <div class="card-icon security">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
      </div>
      <div>
        <h2>Security</h2>
        <p class="card-subtitle">Manage your password and active sessions</p>
      </div>
    </div>
    <div class="formGrid">
      <label>
        <span>Current password</span>
        <input type="password" [(ngModel)]="currentPassword" name="currentPassword" />
      </label>
      <label>
        <span>New password</span>
        <input type="password" [(ngModel)]="newPassword" name="newPassword" />
      </label>
      <label>
        <span>Confirm new password</span>
        <input type="password" [(ngModel)]="confirmPassword" name="confirmPassword" />
      </label>
    </div>
    <div class="actionRow">
      <button type="button" class="primary" [disabled]="changingPassword" (click)="changePassword()">
        {{ changingPassword ? 'Updating...' : 'Change password' }}
      </button>
      <button type="button" class="ghost" (click)="loadSessions()">Refresh sessions</button>
      <button type="button" class="danger" (click)="logoutAllDevices()">Logout all devices</button>
    </div>

    <div class="table" *ngFor="let session of sessions">
      <div>
        <strong>{{ sessionStatus(session) }}</strong>
        <div class="small">{{ session.userAgent || 'unknown device' }}</div>
        <div class="small">IP: {{ session.ip || 'unknown' }}</div>
      </div>
      <div class="small">last used: {{ session.lastUsedAt ? (session.lastUsedAt | date:'short') : 'never' }}</div>
    </div>
    <div class="small" *ngIf="!sessionsLoading && !sessions.length">No sessions found.</div>
  </article>

  <!-- Admin/Moderation Tab Content -->
  <section *ngIf="activeTab === 'admin' && isModeratorOrHigher()" class="card admin-card">
    <div class="card-header">
      <div class="card-icon admin">
        <svg viewBox="0 0 24 24" width="24" height="24" fill="currentColor"><path d="M12 1L3 5v6c0 5.55 3.84 10.74 9 12 5.16-1.26 9-6.45 9-12V5l-9-4zm0 10.99h7c-.53 4.12-3.28 7.79-7 8.94V12H5V6.3l7-3.11v8.8z"/></svg>
      </div>
      <div>
        <h2>Moderation workspace</h2>
        <p class="card-subtitle">Manage users, reports, and system events</p>
      </div>
    </div>
    <p *ngIf="adminMessage" class="notice info">{{ adminMessage }}</p>

    <div class="row">
      <input type="text" [(ngModel)]="adminSearch" placeholder="Search users" />
      <select [(ngModel)]="adminUsersRole">
        <option value="">all roles</option>
        <option value="user">user</option>
        <option value="moderator">moderator</option>
        <option value="support">support</option>
        <option value="admin">admin</option>
      </select>
      <select [(ngModel)]="adminUsersVerified">
        <option value="">any verify state</option>
        <option value="true">verified</option>
        <option value="false">unverified</option>
      </select>
      <button type="button" class="ghost" (click)="loadAdminData()">Refresh</button>
    </div>

    <h3>Users</h3>
    <div class="table" *ngFor="let user of adminUsers">
      <div>
        <strong>{{ user.username }}</strong>
        <div class="small">
          {{ user.email || 'no email' }} ¬∑ role: {{ user.role }} ¬∑ state: {{ userModerationState(user) }}
        </div>
      </div>
      <div class="actions">
        <button type="button" class="ghost" (click)="verifyEmail(user)">Verify</button>
        <button type="button" class="ghost" (click)="unlockUser(user)">Unlock</button>
        <button type="button" class="ghost" (click)="revokeSessions(user)">Revoke sessions</button>
        <button type="button" class="ghost" (click)="banUserWeek(user)">Ban 1 week</button>
        <button type="button" class="danger" (click)="blockUser(user)">Block</button>
        <button type="button" class="ghost" *ngIf="userModerationState(user) !== 'active'" (click)="unblockUser(user)">Unblock</button>
        <select *ngIf="isAdmin()" [ngModel]="user.role" (ngModelChange)="setRole(user, $event)">
          <option *ngFor="let role of roleOptionsForCurrentUser()" [ngValue]="role">{{ role }}</option>
        </select>
      </div>
    </div>
    <div class="pagerRow">
      <button type="button" class="ghost" (click)="prevUsersPage()" [disabled]="usersPage <= 1">Prev</button>
      <span class="small">page {{ usersPage }} / {{ usersPages }}</span>
      <button type="button" class="ghost" (click)="nextUsersPage()" [disabled]="usersPage >= usersPages">Next</button>
    </div>

    <ng-container *ngIf="adminReports.length">
    <h3>Attachment reports</h3>
    <div class="row">
      <select [(ngModel)]="adminReportsStatus">
        <option value="">all status</option>
        <option value="pending">pending</option>
        <option value="in_review">in_review</option>
        <option value="resolved">resolved</option>
        <option value="dismissed">dismissed</option>
      </select>
      <select [(ngModel)]="adminReportsCategory">
        <option value="">all category</option>
        <option value="spam">spam</option>
        <option value="harassment">harassment</option>
        <option value="violence">violence</option>
        <option value="sexual">sexual</option>
        <option value="copyright">copyright</option>
        <option value="other">other</option>
      </select>
      <select [(ngModel)]="adminReportsScope">
        <option value="">all scope</option>
        <option value="public">public</option>
        <option value="private">private</option>
      </select>
      <select [(ngModel)]="adminReportsSeverity">
        <option value="">all severity</option>
        <option value="low">low</option>
        <option value="medium">medium</option>
        <option value="high">high</option>
      </select>
      <button type="button" class="ghost" (click)="loadAdminData()">Apply</button>
    </div>

    <div class="table" *ngFor="let report of adminReports">
      <div>
        <strong>{{ report.scope }} ¬∑ {{ report.category }}</strong>
        <div class="small">status: {{ report.status }} ¬∑ messageId: {{ report.messageId }}</div>
      </div>
      <div class="actions">
        <button type="button" class="ghost" (click)="openReportReview(report)">Review</button>
        <button type="button" class="ghost" (click)="updateReportStatus(report, 'dismissed')">Dismiss</button>
      </div>
    </div>
    <div class="pagerRow">
      <button type="button" class="ghost" (click)="prevReportsPage()" [disabled]="reportsPage <= 1">Prev</button>
      <span class="small">page {{ reportsPage }} / {{ reportsPages }}</span>
      <button type="button" class="ghost" (click)="nextReportsPage()" [disabled]="reportsPage >= reportsPages">Next</button>
    </div>
    </ng-container>

    <ng-container *ngIf="abuseEvents.length">
    <h3>Auth abuse events</h3>
    <div class="table" *ngFor="let event of abuseEvents">
      <div>
        <strong>{{ event.type }}</strong>
        <div class="small">{{ event.identifier || event.ip || '-' }} ¬∑ severity {{ event.severity }}</div>
      </div>
      <div class="small">{{ event.createdAt | date:'short' }}</div>
    </div>
    <div class="pagerRow">
      <button type="button" class="ghost" (click)="prevAbusePage()" [disabled]="abusePage <= 1">Prev</button>
      <span class="small">page {{ abusePage }} / {{ abusePages }}</span>
      <button type="button" class="ghost" (click)="nextAbusePage()" [disabled]="abusePage >= abusePages">Next</button>
    </div>
    </ng-container>

    <h3>Moderation audit actions</h3>
    <div class="table" *ngFor="let item of adminAuditActions">
      <div>
        <strong>{{ item.action }}</strong>
        <div class="small">{{ item.actorUsername }} ({{ item.actorRole }}) -> {{ item.targetType }} {{ item.targetId || '-' }}</div>
      </div>
      <div class="small">{{ item.createdAt | date:'short' }}</div>
    </div>
    <div class="pagerRow">
      <button type="button" class="ghost" (click)="prevAuditPage()" [disabled]="auditPage <= 1">Prev</button>
      <span class="small">page {{ auditPage }} / {{ auditPages }}</span>
      <button type="button" class="ghost" (click)="nextAuditPage()" [disabled]="auditPage >= auditPages">Next</button>
    </div>
  </section>

  <div class="reviewOverlay" *ngIf="reviewOpen" (click)="closeReportReview()">
    <div class="reviewModal" (click)="$event.stopPropagation()">
      <div class="reviewHeader">
        <h3>Report review</h3>
        <button type="button" class="ghost" (click)="closeReportReview()">Close</button>
      </div>

      <p class="small" *ngIf="reviewLoading">Loading report details...</p>

      <ng-container *ngIf="!reviewLoading && reviewReport">
        <p class="small">Category: {{ reviewReport.category }} ¬∑ Scope: {{ reviewReport.scope }} ¬∑ Status: {{ reviewReport.status }}</p>
        <p class="small">Reported by: {{ reviewReport.reportedBy }}</p>
        <p class="small">Message by: {{ reviewAuthor?.username || reviewMessage?.from || 'unknown' }}</p>
        <p class="small">Message text:</p>
        <div class="reviewMessageBox">{{ reviewMessage?.text || '(no text)' }}</div>

        <div class="reviewAttachments" *ngIf="reviewMessageAttachments().length; else noAttachmentsTpl">
          <h4>Attachments</h4>
          <div class="reviewAttachmentItem" *ngFor="let attachment of reviewMessageAttachments()">
            <a [href]="reviewAttachmentUrl(attachment)" target="_blank" rel="noreferrer">{{ attachment.name || attachment.url }}</a>
            <span class="small">{{ attachment.mimeType || 'file' }}</span>
          </div>
        </div>
        <ng-template #noAttachmentsTpl>
          <p class="small">No attachments on this message.</p>
        </ng-template>

        <div class="reviewActions">
          <button type="button" class="danger" (click)="reviewDeleteMessage()" [disabled]="reviewActionBusy">Delete message</button>
          <button type="button" class="ghost" (click)="reviewDismiss()" [disabled]="reviewActionBusy">Dismiss report</button>
          <button type="button" class="ghost" (click)="reviewBanUserWeek()" [disabled]="reviewActionBusy || !reviewAuthor?._id">Ban user 1 week</button>
          <button type="button" class="danger" (click)="reviewBlockUser()" [disabled]="reviewActionBusy || !reviewAuthor?._id">Block user</button>
        </div>
      </ng-container>
    </div>
  </div>
</section>

<ng-template #loadingTpl>
  <section class="profile-page">
    <header class="topbar">
      <div style="flex: 1;">
        <p class="eyebrow">Account center</p>
        <app-skeleton-loader variant="text" style="width: 250px; height: 28px; margin-top: 8px;"></app-skeleton-loader>
      </div>
      <app-skeleton-loader variant="button"></app-skeleton-loader>
    </header>

    <div class="layoutGrid">
      <aside class="card profileHero">
        <div class="avatarRow">
          <app-skeleton-loader variant="avatar"></app-skeleton-loader>
          <app-skeleton-loader variant="button"></app-skeleton-loader>
        </div>
        <app-skeleton-loader variant="text" style="width: 150px; height: 20px; margin: 16px 0;"></app-skeleton-loader>
        <app-skeleton-loader variant="text" style="width: 100px; height: 16px; margin-bottom: 16px;"></app-skeleton-loader>
        <div style="margin-top: 16px;">
          <app-skeleton-loader variant="text" style="height: 14px; margin-bottom: 8px;"></app-skeleton-loader>
          <app-skeleton-loader variant="text" style="height: 14px; margin-bottom: 8px;"></app-skeleton-loader>
          <app-skeleton-loader variant="text" style="height: 14px;"></app-skeleton-loader>
        </div>
      </aside>

      <article class="card">
        <app-skeleton-loader variant="text" style="width: 150px; height: 24px; margin-bottom: 16px;"></app-skeleton-loader>
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 14px;">
          <app-skeleton-loader variant="input"></app-skeleton-loader>
          <app-skeleton-loader variant="input"></app-skeleton-loader>
          <app-skeleton-loader variant="input"></app-skeleton-loader>
          <app-skeleton-loader variant="input"></app-skeleton-loader>
        </div>
        <app-skeleton-loader variant="button" style="margin-top: 16px;"></app-skeleton-loader>
      </article>
    </div>

    <article class="card" style="margin-top: 18px;">
      <app-skeleton-loader variant="text" style="width: 150px; height: 24px; margin-bottom: 16px;"></app-skeleton-loader>
      <div style="display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 14px;">
        <app-skeleton-loader variant="input"></app-skeleton-loader>
        <app-skeleton-loader variant="input"></app-skeleton-loader>
        <app-skeleton-loader variant="input"></app-skeleton-loader>
      </div>
      <div style="display: flex; gap: 10px; margin-top: 16px;">
        <app-skeleton-loader variant="button"></app-skeleton-loader>
        <app-skeleton-loader variant="button"></app-skeleton-loader>
        <app-skeleton-loader variant="button"></app-skeleton-loader>
      </div>
    </article>
  </section>
</ng-template>

<!-- Preview Modal -->
<div class="modal-overlay" *ngIf="previewOpen" (click)="closePreview()" role="dialog" aria-label="Profile Preview" aria-modal="true" tabindex="0" (keydown.escape)="closePreview()">
  <div class="modal-content preview-card" (click)="$event.stopPropagation()" tabindex="-1" aria-label="Profile Preview">
    <div class="preview-header">
      <div>
        <h2>Profile Preview</h2>
        <div class="subtitle">Live preview of how your profile appears to others</div>
      </div>
      <button type="button" class="ghost" (click)="closePreview()">‚úï</button>
    </div>
    <div class="preview-body">
      <div class="preview-profile-row">
        <div class="preview-avatar-section">
          <div class="preview-avatar">
            <img *ngIf="avatarPreviewUrl()" [src]="avatarPreviewUrl()" alt="avatar" />
            <div *ngIf="!avatarPreviewUrl()" class="avatarPlaceholder">No avatar</div>
          </div>
        </div>
        <div class="preview-info-section">
          <div class="preview-name-row">
            <h3>{{ displayName || me?.username }}</h3>
            <span class="preview-badge role">{{ me?.role || 'user' }}</span>
            <span class="preview-badge verified" *ngIf="me?.emailVerified">‚úì Verified</span>
            <span class="preview-badge online" *ngIf="showOnlineStatus" title="Online">
              <span class="online-dot"></span> Online
            </span>
          </div>
          <p class="username">@{{ me?.username }}</p>
          <div class="preview-status" *ngIf="statusText">
            <span>üìù</span> {{ statusText }}
          </div>
        </div>
      </div>
      <p class="preview-bio" *ngIf="bio">{{ bio }}</p>
      <div class="preview-details">
        <p *ngIf="showGender"><span class="label">Gender:</span> {{ gender }}</p>
        <p *ngIf="showAge"><span class="label">Age:</span> {{ ageLabel() }}</p>
        <p *ngIf="showCountry"><span class="label">Country:</span> {{ countryLabel() }}</p>
        <p><span class="label">Joined:</span> {{ me?.createdAt | date:'mediumDate' }}</p>
      </div>
      <div class="preview-social" *ngIf="hasAnySocialLink()">
        <ng-container *ngFor="let p of socialPlatforms">
          <a *ngIf="hasSocialLink(p.id)" [href]="getSocialLink(p.id)" target="_blank" rel="noopener noreferrer" 
             class="social-icon-img" [title]="p.name + ': ' + getSocialLink(p.id)"
             [innerHTML]="getPlatformSvgSafe(p.id)"></a>
        </ng-container>
      </div>
    </div>
  </div>
</div>
